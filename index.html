<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Quote of the Day</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="quote-box">
    <h2>Quote of the Day</h2>

    <blockquote id="quote" class="loading">
      <div class="spinner"></div>
      Loading inspiring quote...
    </blockquote>
    <span id="author"></span>

    <div class="btns">
      <button onclick="getQuote()" id="newQuoteBtn">
        üîÑ New Quote
      </button>
      <button class="btn-copy" onclick="copyToClipboard()" id="copyBtn">
        üìã Copy
      </button>
      <button onclick="share('twitter')">
        üê¶ Twitter
      </button>
      <button onclick="share('whatsapp')">
        üí¨ WhatsApp
      </button>
      <button onclick="share('linkedin')">
        üíº LinkedIn
      </button>
    </div>

    <div class="dark-toggle">
      <span>üåô</span>
      <div class="toggle-switch" onclick="toggleDarkMode()">
        <div class="toggle-slider"></div>
      </div>
      <span>‚òÄÔ∏è</span>
    </div>
  </div>

  <script>
    const quote = document.getElementById("quote");
    const author = document.getElementById("author");
    const newQuoteBtn = document.getElementById("newQuoteBtn");
    const copyBtn = document.getElementById("copyBtn");
    
    // Direct API endpoint
    const api_url = "https://api.quotable.io/random";

    // Load dark mode preference
    const isDarkMode = localStorage.getItem('darkMode') === 'true';
    if (isDarkMode) {
      document.body.classList.add('dark');
      document.querySelector('.toggle-switch').classList.add('active');
    }

    async function getQuote() {
      try {
        // Show loading state
        quote.innerHTML = '<div class="spinner"></div>Loading inspiring quote...';
        quote.className = 'loading';
        author.innerHTML = '';
        newQuoteBtn.disabled = true;

        const response = await fetch(api_url);
        
        if (!response.ok) {
          throw new Error('Failed to fetch quote');
        }
        
        const data = await response.json();
        
        // Add a small delay for better UX
        setTimeout(() => {
          quote.innerHTML = data.content;
          quote.className = '';
          author.innerHTML = `‚Äî ${data.author}`;
          newQuoteBtn.disabled = false;
        }, 500);
        
      } catch (error) {
        quote.innerHTML = "Failed to load quote. Please try again.";
        quote.className = 'error';
        author.innerHTML = "";
        newQuoteBtn.disabled = false;
        console.error("Error fetching quote:", error);
      }
    }

    function share(platform) {
      const quoteText = quote.textContent.replace(/"/g, '');
      const authorText = author.textContent;
      const text = `"${quoteText}" ${authorText}`;
      const encodedText = encodeURIComponent(text);
      
      let url = '';
      switch (platform) {
        case 'twitter':
          url = `https://twitter.com/intent/tweet?text=${encodedText}`;
          break;
        case 'whatsapp':
          url = `https://wa.me/?text=${encodedText}`;
          break;
        case 'linkedin':
          url = `https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(window.location.href)}&title=${encodedText}`;
          break;
        default:
          return;
      }
      
      window.open(url, 'share-window', 'width=600,height=400');
    }

    async function copyToClipboard() {
      const quoteText = quote.textContent.replace(/"/g, '');
      const authorText = author.textContent;
      const text = `"${quoteText}" ${authorText}`;
      
      try {
        await navigator.clipboard.writeText(text);
        
        // Show success feedback
        const originalText = copyBtn.innerHTML;
        copyBtn.innerHTML = '‚úÖ Copied!';
        copyBtn.classList.add('copied');
        
        setTimeout(() => {
          copyBtn.innerHTML = originalText;
          copyBtn.classList.remove('copied');
        }, 2000);
        
      } catch (err) {
        // Fallback for older browsers
        const textArea = document.createElement('textarea');
        textArea.value = text;
        document.body.appendChild(textArea);
        textArea.select();
        document.execCommand('copy');
        document.body.removeChild(textArea);
        
        copyBtn.innerHTML = '‚úÖ Copied!';
        copyBtn.classList.add('copied');
        
        setTimeout(() => {
          copyBtn.innerHTML = 'üìã Copy';
          copyBtn.classList.remove('copied');
        }, 2000);
      }
    }

    function toggleDarkMode() {
      const body = document.body;
      const toggle = document.querySelector('.toggle-switch');
      
      body.classList.toggle('dark');
      toggle.classList.toggle('active');
      
      // Save preference
      const isDark = body.classList.contains('dark');
      localStorage.setItem('darkMode', isDark);
    }

    // Load initial quote
    getQuote();

    // Add keyboard shortcuts
    document.addEventListener('keydown', function(e) {
      if (e.key === ' ' || e.key === 'Enter') {
        e.preventDefault();
        getQuote();
      } else if (e.key === 'c' || e.key === 'C') {
        copyToClipboard();
      } else if (e.key === 'd' || e.key === 'D') {
        toggleDarkMode();
      }
    });
  </script>
</body>
</html>